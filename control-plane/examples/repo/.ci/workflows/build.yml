name: Build and Test

jobs:
  build:
    name: Build
    steps:
      - name: Build Binary
        # need to add workspace/
        # remove previous comments
        run: |
          go build -o demo .
          mkdir -p /workspace/artifacts
          cp demo /workspace/artifacts/demo-binary
          echo "Build: $(date)" > /workspace/artifacts/build-info.txt
          ls -lh /workspace/artifacts/
  
  test:
    name: Test
    needs: [build]
    steps:
      - name: Run Tests
        run: |
          go test -v -coverprofile=coverage.out ./...
          mkdir -p /workspace/artifacts
          cp coverage.out /workspace/artifacts/
          echo "Tests passed: $(date)" > /workspace/artifacts/test-report.txt